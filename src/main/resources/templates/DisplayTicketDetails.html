<!DOCTYPE HTML>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

    <title>Ticket Details</title>
    <style>
        /* Optional: Custom CSS styles */
        .date-container {
            font-size: 18px;
            font-weight: bold;
            margin-top: 20px;
            margin-left: auto; /* Align to the right */
        }
        body
        {
                background-color: #F87171;
            background-color: hsl(0, 50%, 80%);/* Replace this with your specific shade of red */

        }
    </style>
</head>

<body>
<header>
    <nav class="navbar navbar-expand-sm navbar-dark  " style="background: #9A616D">
        <div class="container-fluid">


            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mynavbar">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="mynavbar">
                <ul class="navbar-nav mr-auto" >
                    <li class="nav-item">
                        <a class="nav-link" href="" th:href="@{/}" style="color: white">Home</a>
                    </li>
                </ul>

            </div>
            <div class="collapse navbar-collapse" >
                <ul class="navbar-nav mr-auto" >
                    <li class="nav-item">
                        <a class="nav-link" href=" "  style="color: white;text-decoration: underline">Coupen Add</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="" th:href="@{/drawPort}" style="color: white">Draw Port</a>
                    </li>
                </ul>

            </div>


            <a class="nav-link" href="">
                <form action="#" th:action="@{/logout}" method="post">

                    <button class="btn " type="submit" style="background: #9A616D;color: white">
                        logout<i class="bi bi-box-arrow-left m-2"></i></button>
                </form>
            </a>

        </div>
    </nav>
</header>

<div class="container">
    <div class="d-flex">
    <h3 class="mt-3" th:text="${ticketName.ticket}"></h3>
    <div class="date-container" id="date-container"></div>
    </div>
    <hr>
    <div class="row">
<div class="col-md-4">
    <form th:action="@{/addTicket}" th:object="${ticketDetails}" method="post">
        <div class="mb-4">
            <input type="text" th:field="*{name}" placeholder="Name" class="form-control mb-3">
            <textarea th:field="*{enterDetails}" placeholder="Coupon Number" id="inputItem" class="form-control mb-3" rows="6" required></textarea>
            <div class="row">
            <div class="col-md-6">
                <div class="mb-4">
                    <input class="form-control" name="date" th:value="${formattedDate}" type="date"/>
                </div>
            </div>

            <div class="col-md-6">
                <div class="mb-4">
                    <input class="form-control" type="text" name="limit" th:value="20" placeholder="Enter the Limit"/>
                </div>
            </div>
            </div>
        </div>
            <input class="form-control" name="ticket" th:value="${ticketName.id}" type="hidden">

        <input type="submit" value="Submit" class="btn btn-primary"/>
        <input type="button" value="Clear" class="btn btn-danger" id="btnClear" onclick="clearInput()"/>
    </form>

</div>

    <div class="col-md-4 d-flex justify-content-center align-items-start">
        <div class="bg-light"  >
            <table class="table">

                <tbody>


                <tr th:each="count: ${ticketCount}">
                    <th scope="row" th:text="${count.coupenType}+' '+'count'"></th>

                    <th scope="row" th:text="':'+' '+${count.totelCount}"></th>


                </tr>



                </tbody>
            </table>
        </div>

    </div>
        <div class="col-md-4 d-flex justify-content-center align-items-center ">
        <div class="bg-light"  >

            <form th:action="@{/deleteSelectesError}" id="deleteForm">
<!--                <button type="button" class="btn btn-primary" >Copy Selected</button>-->
                <button type="submit" class="btn btn-primary m-2" id="deleteSelectedError" onclick="copySelectedItems()">Copy and Delete Selected</button>
                <input type="hidden" th:value="${ticketId.id}" name="tid">
                <table class="table">
                    <tbody>
                    <tr>
                        <th>
                            <input type="checkbox" id="selectAllCheckbox1" onchange="toggleAllCheckboxes1(this)">
                        </th>
                        <th>Error Message</th>
                    </tr>
                    <tr th:each="item, iterStat : ${error}">
                        <td>
                            <input type="checkbox" class="rowCheckbox1" name="selectedItems" th:value="${item.id}" />


                        </td>
                        <td th:text="${item.coupen}"></td>
                    </tr>
                    </tbody>
                </table>
                </form>



        </div>
        </div>


    </div>
    <div class="row">
    <div class="col-md-7"></div>
<div class="col-md-5">
    <div class="container">
        <div class="row justify-content-end">
            <div class="col">
                <form th:action="@{/search}" method="get" class="form-inline">
                    <div class="col-md-6"></div>
                    <input type="text" class="mr-2" name="keyword"  required />
                    <input type="hidden" th:each="ticket :${ticketDetail}" th:value="${ticket.ticket.id}" name="tid">
                    <button type="submit" class="btn btn-primary mr-2">Search</button>
                    <a class="btn btn-primary" th:href="@{/showAll(ticketId=${ticketId.id})}">Show All</a>
                </form>
            </div>
        </div>
    </div>
</div>
    </div>

    <form th:action="@{/deleteSelectes}" >
        <button type="submit" class="btn btn-danger mt-3" id="deleteSelectedButton"  onclick="if (!confirm('Are you sure want to delete this ticket'))return false">Delete Selected Items</button>


    <table class="table table-bordered table-striped mt-3 bg-light">
        <thead class="table-dark">
        <tr>
            <th>
                <input type="checkbox" id="selectAllCheckbox" onchange="toggleAllCheckboxes(this)">
            </th>

            <th>Sl No</th>

            <th> Coupen number</th>
            <th>Name</th>
            <th>Type</th>
            <th>Count</th>
            <th>Rate</th>



        </tr>
        </thead>

        <tbody>

        <input type="hidden" th:value="${ticketId.id}" name="tid">


        <tr th:each="tickets,iterStat : ${ticketDetail}">
            <td>
                <input type="checkbox" class="rowCheckbox" name="cid" th:value="${tickets.id}" />

            </td>


            <td class="ticketId" th:text="${iterStat.count}" />
            <td th:text="${tickets.coupenNumber}" />
            <td th:text="${tickets.name}" />
            <td th:text="${tickets.type}"></td>
            <td th:text="${tickets.count}" />
            <td th:text="${tickets.rate}"></td>

<!--            <td>-->


<!--                <a class="btn btn-danger btn-sm"-->
<!--                   th:href="@{/delete(ticketId=${tickets.id})}"-->
<!--                   onclick="if (!confirm('Are you sure want to delete this ticket'))return false ">-->
<!--                    Delete-->
<!--                </a>-->
<!--            </td>-->

        </tr>
        </tbody>
    </table>
        <hr>
        <h3>Coupon above limit</h3>

    </form>
    <form th:action="@{/deleteLimit}" >
        <button type="submit" class="btn btn-danger" id="deleteSelectedButton2"  onclick="if (!confirm('Are you sure want to delete this ticket'))return false">Delete Selected Items</button>

        <table class="table table-bordered table-striped mt-3 bg-light">
        <thead class="table-dark">
        <tr>
            <th>
                <input type="checkbox" id="selectAllCheckbox2" onchange="toggleAllCheckboxes2(this)">
            </th>

            <th>Sl No</th>

            <th> Coupen number</th>
            <th>Name</th>
            <th>Type</th>
            <th>Count</th>
            <th>Rate</th>



        </tr>
        </thead>

        <tbody>

        <input type="hidden" th:value="${ticketId.id}" name="tid">


        <tr th:each="tickets,iterStat : ${limit}">
            <td>
                <input type="checkbox" class="rowCheckbox2" name="cid" th:value="${tickets.id}" />

            </td>


            <td class="ticketId" th:text="${iterStat.count}" />
            <td th:text="${tickets.coupenNumber}" />
            <td th:text="${tickets.name}" />
            <td th:text="${tickets.type}"></td>
            <td th:text="${tickets.count}" />
            <td th:text="${tickets.rate}"></td>

            <!--            <td>-->


            <!--                <a class="btn btn-danger btn-sm"-->
            <!--                   th:href="@{/delete(ticketId=${tickets.id})}"-->
            <!--                   onclick="if (!confirm('Are you sure want to delete this ticket'))return false ">-->
            <!--                    Delete-->
            <!--                </a>-->
            <!--            </td>-->

        </tr>
        </tbody>
    </table>
    </form>
</div>
<script>
    // JavaScript code to display today's date
    document.addEventListener('DOMContentLoaded', function () {
        var dateContainer = document.getElementById('date-container');
        var today = new Date();
        var options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        var formattedDate = today.toLocaleDateString('en-US', options);
        dateContainer.innerText = formattedDate;
    });
    function clearInput() {
        document.getElementById("inputItem").value = "";
    }
</script>
<script>
    function toggleAllCheckboxes(checkbox) {
        var checkboxes = document.getElementsByClassName('rowCheckbox');
        for (var i = 0; i < checkboxes.length; i++) {
            checkboxes[i].checked = checkbox.checked;
        }
    }
    function toggleAllCheckboxes1(checkbox) {
        var checkboxes = document.getElementsByClassName('rowCheckbox1');
        for (var i = 0; i < checkboxes.length; i++) {
            checkboxes[i].checked = checkbox.checked;
        }
    }
    function toggleAllCheckboxes2(checkbox) {
        var checkboxes = document.getElementsByClassName('rowCheckbox2');
        // Check if there are any checkboxes
        if (checkboxes.length > 0) {
            for (var i = 0; i < checkboxes.length; i++) {
                checkboxes[i].checked = checkbox.checked;
            }
        }
    }

    function copySelectedItems() {
        var selectedItems = [];
        var checkboxes = document.querySelectorAll('.rowCheckbox1:checked');
        checkboxes.forEach(function(checkbox) {
            var itemText = checkbox.parentElement.nextElementSibling.textContent.trim();
            selectedItems.push(itemText);
        });
        if (selectedItems.length === 0) {
            alert('Please select at least one item to copy.');
            return ; // Exit the function
        }

        var copiedText = selectedItems.join('\n');

        // Copy the selected items to the clipboard
        navigator.clipboard.writeText(copiedText)
            .then(function() {
                console.log('Selected items copied to clipboard');

            })
            .catch(function(err) {
                console.error('Unable to copy:', err);
                alert('Unable to copy the selected items to clipboard');
            });
    }



</script>


</body>
</html>



